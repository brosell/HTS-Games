<HTML>
<HEAD>
<TITLE>
Skin.cpp
</TITLE>
</HEAD>
<BODY>
<PRE>
<font color="blue">#pragma</font> <font color="blue">warning</font> <font color="black">(</font>disable <font color="black">:</font> <font color="maroon">4786</font><font color="black">)</font>

<font color="blue">#include</font> <font color="maroon">"Skin.h"</font>

Skin<font color="black">:</font><font color="black">:</font>Skin<font color="black">(</font><font color="black">)</font>
<font color="black">{</font>
<font color="black">}</font>

Skin<font color="black">:</font><font color="black">:</font>~Skin<font color="black">(</font><font color="black">)</font>
<font color="black">{</font>
  m_listeners.clear<font color="black">(</font><font color="black">)</font>;
<font color="black">}</font>

<font color="blue">void</font> Skin<font color="black">:</font><font color="black">:</font>addListener<font color="black">(</font>SkinListener<font color="black">*</font> listener<font color="black">)</font>
<font color="black">{</font>
  m_listeners.insert<font color="black">(</font>listener<font color="black">)</font>;
<font color="black">}</font>
<font color="blue">void</font> Skin<font color="black">:</font><font color="black">:</font>removeListener<font color="black">(</font>SkinListener<font color="black">*</font> listener<font color="black">)</font>
<font color="black">{</font>
  m_listeners.erase<font color="black">(</font>listener<font color="black">)</font>;
<font color="black">}</font>

<font color="blue">void</font> Skin<font color="black">:</font><font color="black">:</font>blit<font color="black">(</font>Display<font color="black">*</font> display, <font color="blue">int</font> x, <font color="blue">int</font> y, <font color="blue">bool</font> centerCoords<font color="black">)</font>
<font color="black">{</font>
  HTexture texture <font color="black">=</font> currentFrame<font color="black">(</font><font color="black">)</font>;
  <font color="blue">if</font> <font color="black">(</font>texture <font color="black">!</font><font color="black">=</font> <font color="maroon">0</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">if</font> <font color="black">(</font>centerCoords<font color="black">)</font>
    <font color="black">{</font>
      <font color="blue">const</font> TextureInfo<font color="black">*</font> ti <font color="black">=</font> display<font color="black">-</font><font color="black">&#62;</font>getTextureInfo<font color="black">(</font>texture<font color="black">)</font>;
      display<font color="black">-</font><font color="black">&#62;</font>blit<font color="black">(</font>texture, x<font color="black">-</font><font color="black">(</font>ti<font color="black">-</font><font color="black">&#62;</font>w<font color="black">/</font><font color="maroon">2</font><font color="black">)</font>, y<font color="black">-</font><font color="black">(</font>ti<font color="black">-</font><font color="black">&#62;</font>h<font color="black">/</font><font color="maroon">2</font><font color="black">)</font><font color="black">)</font>;
    <font color="black">}</font>
    <font color="blue">else</font>
    <font color="black">{</font>
      display<font color="black">-</font><font color="black">&#62;</font>blit<font color="black">(</font>texture, x, y<font color="black">)</font>;
    <font color="black">}</font>
  <font color="black">}</font>
<font color="black">}</font>


<font color="blue">void</font> Skin<font color="black">:</font><font color="black">:</font>skinLooped<font color="black">(</font><font color="black">)</font>
<font color="black">{</font>
  m_loopEvent.skin <font color="black">=</font> <font color="blue">this</font>;
  set<font color="black">&#60;</font>SkinListener<font color="black">*</font><font color="black">&#62;</font><font color="black">:</font><font color="black">:</font>iterator i;
  set<font color="black">&#60;</font>SkinListener<font color="black">*</font><font color="black">&#62;</font> copy<font color="black">(</font>m_listeners<font color="black">)</font>;
  <font color="blue">for</font> <font color="black">(</font>i<font color="black">=</font>copy.begin<font color="black">(</font><font color="black">)</font>; i<font color="black">!</font><font color="black">=</font>copy.end<font color="black">(</font><font color="black">)</font>; i<font color="black">+</font><font color="black">+</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="black">(</font><font color="black">*</font>i<font color="black">)</font><font color="black">-</font><font color="black">&#62;</font>skinLooped<font color="black">(</font><font color="black">&</font>m_loopEvent<font color="black">)</font>;
  <font color="black">}</font>
<font color="black">}</font>
</PRE>
</BODY>
</HTML>
