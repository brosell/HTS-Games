<HTML>
<HEAD>
<TITLE>
GameMath.h
</TITLE>
</HEAD>
<BODY>
<PRE>
<font color="blue">#ifndef</font> _GameMath_h
<font color="blue">#define</font> _GameMath_h

<font color="blue">#include</font> <font color="maroon">&#60;float.h&#62;</font>
<font color="blue">#include</font> <font color="maroon">&#60;math.h&#62;</font>
<font color="blue">#include</font> <font color="maroon">&#60;windows.h&#62;</font>
<font color="blue">#include</font> <font color="maroon">"SDL.h"</font>

<font color="blue">#include</font> <font color="maroon">&#60;string&#62;</font>

<font color="blue">extern</font> <font color="blue">float</font> sintable<font color="black">[</font><font color="maroon">360</font><font color="black">]</font>;
<font color="blue">extern</font> <font color="blue">float</font> costable<font color="black">[</font><font color="maroon">360</font><font color="black">]</font>;

<font color="blue">#define</font> BR_PI <font color="maroon">3</font>.<font color="maroon">141592654</font>

<font color="blue">const</font> <font color="blue">int</font> bTOP <font color="black">=</font> <font color="maroon">1</font>;
<font color="blue">const</font> <font color="blue">int</font> bBOTTOM <font color="black">=</font> <font color="maroon">2</font>;
<font color="blue">const</font> <font color="blue">int</font> bRIGHT <font color="black">=</font> <font color="maroon">4</font>;
<font color="blue">const</font> <font color="blue">int</font> bLEFT <font color="black">=</font> <font color="maroon">8</font>;

<font color="blue">class</font> Angle
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
  Angle<font color="black">(</font><font color="blue">int</font> angle <font color="black">=</font> <font color="maroon">0</font><font color="black">)</font><font color="black">:</font> m_angle<font color="black">(</font>angle<font color="black">)</font> <font color="black">{</font> <font color="black">}</font>
  <font color="blue">float</font> toRadians<font color="black">(</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="maroon">0</font>;
  <font color="black">}</font>

  Angle<font color="black">&</font> <font color="blue">operator</font><font color="black">=</font><font color="black">(</font><font color="blue">int</font> a<font color="black">)</font>
  <font color="black">{</font>
    m_angle <font color="black">=</font> <font color="maroon">0</font>;
    <font color="blue">return</font> <font color="black">(</font><font color="black">*</font><font color="blue">this</font><font color="black">)</font><font color="black">+</font><font color="black">=</font>a;
  <font color="black">}</font>

  <font color="blue">operator</font> <font color="blue">int</font><font color="black">(</font><font color="black">)</font> <font color="black">{</font> <font color="blue">return</font> m_angle; <font color="black">}</font>

  Angle<font color="black">&</font> <font color="blue">operator</font><font color="black">+</font><font color="black">=</font><font color="black">(</font><font color="blue">int</font> a<font color="black">)</font> 
  <font color="black">{</font> 
    m_angle<font color="black">+</font><font color="black">=</font>a;
    <font color="blue">if</font> <font color="black">(</font>m_angle <font color="black">&#62;</font> <font color="maroon">359</font><font color="black">)</font>
    <font color="black">{</font>
      m_angle <font color="black">=</font> m_angle<font color="maroon">-360</font>;
    <font color="black">}</font>
    <font color="blue">if</font> <font color="black">(</font>m_angle <font color="black">&#60;</font> <font color="maroon">0</font><font color="black">)</font>
    <font color="black">{</font>
      m_angle <font color="black">=</font> <font color="maroon">360</font> <font color="black">+</font> m_angle;
    <font color="black">}</font>
    <font color="blue">return</font> <font color="black">*</font><font color="blue">this</font>;
  <font color="black">}</font>

  Angle<font color="black">&</font> <font color="blue">operator</font><font color="black">-</font><font color="black">=</font><font color="black">(</font><font color="blue">int</font> a<font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="black">(</font><font color="black">*</font><font color="blue">this</font><font color="black">)</font><font color="black">+</font><font color="black">=</font><font color="black">(</font><font color="black">-</font>a<font color="black">)</font>;
  <font color="black">}</font>

<font color="blue">private</font><font color="black">:</font>
  <font color="blue">int</font> m_angle;
<font color="black">}</font>;


<font color="green">/////////////////////</font>
<font color="green">//  Point</font>
<font color="green">/////////////////////</font>
<font color="blue">class</font> FPoint;
<font color="blue">class</font> Point
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
  Point<font color="black">(</font><font color="blue">int</font> x, <font color="blue">int</font> y<font color="black">)</font><font color="black">:</font> x<font color="black">(</font>x<font color="black">)</font>, y<font color="black">(</font>y<font color="black">)</font>, shortest<font color="black">(</font>FLT_MAX<font color="black">)</font> <font color="black">{</font><font color="black">}</font>
  Point<font color="black">(</font><font color="black">)</font><font color="black">:</font> x<font color="black">(</font><font color="maroon">0</font><font color="black">)</font>, y<font color="black">(</font><font color="maroon">0</font><font color="black">)</font>, shortest<font color="black">(</font>FLT_MAX<font color="black">)</font> <font color="black">{</font><font color="black">}</font>
  Point<font color="black">(</font><font color="blue">const</font> Point<font color="black">&</font> other<font color="black">)</font><font color="black">:</font> x<font color="black">(</font>other.x<font color="black">)</font>, y<font color="black">(</font>other.y<font color="black">)</font>, shortest<font color="black">(</font>other.shortest<font color="black">)</font> <font color="black">{</font> <font color="black">}</font>
  Point<font color="black">(</font><font color="blue">const</font> FPoint<font color="black">&</font> other<font color="black">)</font>;

  <font color="blue">void</font> rotate<font color="black">(</font>Angle angle<font color="black">)</font>
  <font color="black">{</font>
    x <font color="black">=</font> costable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>x <font color="black">-</font>sintable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>y;
    y <font color="black">=</font> sintable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>x <font color="black">+</font> costable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>y;
  <font color="black">}</font>


  <font color="blue">int</font> x;
  <font color="blue">int</font> y;
  
  <font color="blue">float</font> distanceTo<font color="black">(</font>Point<font color="black">&</font> p<font color="black">)</font>;
  <font color="blue">int</font> distanceToSquared<font color="black">(</font>Point<font color="black">&</font> p<font color="black">)</font>;
  <font color="blue">bool</font> isShortestDistance<font color="black">(</font>Point<font color="black">&</font> p<font color="black">)</font>;

<font color="blue">private</font><font color="black">:</font>
  <font color="blue">float</font> shortest;
<font color="black">}</font>;

<font color="blue">inline</font> <font color="blue">bool</font> <font color="blue">operator</font> <font color="black">=</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> Point<font color="black">&</font> p1, <font color="blue">const</font> Point<font color="black">&</font> p2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font>p1.x <font color="black">=</font><font color="black">=</font> p2.x <font color="black">&</font><font color="black">&</font> p1.y <font color="black">=</font><font color="black">=</font> p2.y<font color="black">)</font>;
<font color="black">}</font>

<font color="blue">inline</font> <font color="blue">bool</font> <font color="blue">operator</font> <font color="black">&#60;</font> <font color="black">(</font><font color="blue">const</font> Point<font color="black">&</font> p1, <font color="blue">const</font> Point<font color="black">&</font> p2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">if</font> <font color="black">(</font>p1.x <font color="black">&#60;</font> p2.x<font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="blue">true</font>;
  <font color="black">}</font>
  <font color="blue">if</font> <font color="black">(</font>p1.x <font color="black">=</font><font color="black">=</font> p2.x<font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> p1.y <font color="black">&#60;</font> p2.y;
  <font color="black">}</font>
  <font color="blue">return</font> <font color="blue">false</font>;
<font color="black">}</font>

<font color="blue">inline</font> <font color="blue">bool</font> <font color="blue">operator</font> <font color="black">!</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> Point<font color="black">&</font> p1, <font color="blue">const</font> Point<font color="black">&</font> p2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font>p1.x <font color="black">!</font><font color="black">=</font> p2.x <font color="black">|</font><font color="black">|</font> p1.y <font color="black">!</font><font color="black">=</font> p2.y<font color="black">)</font>;
<font color="black">}</font>


<font color="green">/////////////////////</font>
<font color="green">//  FPoint</font>
<font color="green">/////////////////////</font>

<font color="blue">class</font> FPoint
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
  FPoint<font color="black">(</font><font color="blue">float</font> x<font color="black">=</font><font color="maroon">0</font>, <font color="blue">float</font> y<font color="black">=</font><font color="maroon">0</font><font color="black">)</font><font color="black">:</font> x<font color="black">(</font>x<font color="black">)</font>, y<font color="black">(</font>y<font color="black">)</font>, shortest<font color="black">(</font>FLT_MAX<font color="black">)</font> <font color="black">{</font><font color="black">}</font>
  FPoint<font color="black">(</font>Point p<font color="black">)</font><font color="black">:</font>x<font color="black">(</font>p.x<font color="black">)</font>, y<font color="black">(</font>p.y<font color="black">)</font>, shortest<font color="black">(</font>FLT_MAX<font color="black">)</font> <font color="black">{</font><font color="black">}</font>

  <font color="blue">void</font> rotate<font color="black">(</font>Angle angle<font color="black">)</font>
  <font color="black">{</font>
    x <font color="black">=</font> costable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>x <font color="black">-</font>sintable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>y;
    y <font color="black">=</font> sintable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>x <font color="black">+</font> costable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>y;
  <font color="black">}</font>

  <font color="blue">float</font> x;
  <font color="blue">float</font> y;

  <font color="blue">float</font> distanceTo<font color="black">(</font>FPoint<font color="black">&</font> p<font color="black">)</font>;
  <font color="blue">float</font> distanceToSquared<font color="black">(</font>FPoint<font color="black">&</font> p<font color="black">)</font>;
  

<font color="blue">bool</font> isShortestDistance<font color="black">(</font>FPoint<font color="black">&</font> p<font color="black">)</font>;

<font color="blue">private</font><font color="black">:</font>
  <font color="blue">float</font> shortest;

<font color="black">}</font>;

<font color="blue">inline</font> <font color="blue">bool</font> <font color="blue">operator</font> <font color="black">=</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> FPoint<font color="black">&</font> p1, <font color="blue">const</font> FPoint<font color="black">&</font> p2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font>p1.x <font color="black">=</font><font color="black">=</font> p2.x <font color="black">&</font><font color="black">&</font> p1.y <font color="black">=</font><font color="black">=</font> p2.y<font color="black">)</font>;
<font color="black">}</font>

<font color="blue">inline</font> <font color="blue">bool</font> <font color="blue">operator</font> <font color="black">!</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> FPoint<font color="black">&</font> p1, <font color="blue">const</font> FPoint<font color="black">&</font> p2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font>p1.x <font color="black">!</font><font color="black">=</font> p2.x <font color="black">|</font><font color="black">|</font> p1.y <font color="black">!</font><font color="black">=</font> p2.y<font color="black">)</font>;
<font color="black">}</font>


<font color="green">/////////////////////</font>
<font color="green">//  Rect </font>
<font color="green">/////////////////////</font>
<font color="blue">struct</font> Rect
<font color="black">{</font>
  Rect<font color="black">(</font><font color="blue">int</font> x, <font color="blue">int</font> y, <font color="blue">int</font> w, <font color="blue">int</font> h<font color="black">)</font><font color="black">:</font> x<font color="black">(</font>x<font color="black">)</font>, y<font color="black">(</font>y<font color="black">)</font>, w<font color="black">(</font>w<font color="black">)</font>, h<font color="black">(</font>h<font color="black">)</font> <font color="black">{</font><font color="black">}</font>
  Rect<font color="black">(</font><font color="black">)</font> <font color="black">{</font><font color="black">}</font>
  Rect<font color="black">(</font><font color="blue">const</font> Rect<font color="black">&</font> other<font color="black">)</font>
  <font color="black">{</font>
    x<font color="black">=</font>other.x;
    y<font color="black">=</font>other.y;
    w<font color="black">=</font>other.w;
    h<font color="black">=</font>other.h;
  <font color="black">}</font>
  <font color="blue">int</font> x;
  <font color="blue">int</font> y;
  <font color="blue">int</font> w;
  <font color="blue">int</font> h;

  <font color="blue">bool</font> containsPoint<font color="black">(</font>Point<font color="black">&</font> p<font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="black">(</font> <font color="black">(</font>p.x <font color="black">&#62;</font><font color="black">=</font> x<font color="black">)</font> <font color="black">&</font><font color="black">&</font> 
             <font color="black">(</font>p.x <font color="black">&#60;</font> x<font color="black">+</font>w<font color="black">)</font> <font color="black">&</font><font color="black">&</font>
             <font color="black">(</font>p.y <font color="black">&#62;</font><font color="black">=</font> y<font color="black">)</font> <font color="black">&</font><font color="black">&</font>
             <font color="black">(</font>p.y <font color="black">&#60;</font> y<font color="black">+</font>h<font color="black">)</font> <font color="black">)</font>;
  <font color="black">}</font>

  <font color="blue">operator</font> SDL_Rect<font color="black">*</font><font color="black">(</font><font color="black">)</font>
  <font color="black">{</font>
    m_sdl.x <font color="black">=</font> x;
    m_sdl.y <font color="black">=</font> y;
    m_sdl.w <font color="black">=</font> w;
    m_sdl.h <font color="black">=</font> h;
    <font color="blue">return</font> <font color="black">&</font>m_sdl;
  <font color="black">}</font>

  <font color="blue">static</font> <font color="blue">bool</font> checkOverlap<font color="black">(</font>Rect<font color="black">*</font> r1, Rect<font color="black">*</font> r2<font color="black">)</font>;
  
  
  <font color="green">// returns the portion of overlapper that overlaps into overlappee</font>
  <font color="blue">static</font> Rect findOverlap<font color="black">(</font>Rect<font color="black">*</font> overlapper, Rect<font color="black">*</font> overlappee<font color="black">)</font>;
  <font color="blue">static</font> <font color="blue">int</font> impactSide<font color="black">(</font>Rect<font color="black">*</font> hitter, Rect<font color="black">*</font> hittee<font color="black">)</font>;
  <font color="blue">static</font> Rect parseRect<font color="black">(</font>std<font color="black">:</font><font color="black">:</font>string strRect<font color="black">)</font>;

<font color="blue">private</font><font color="black">:</font>
  SDL_Rect m_sdl;
<font color="black">}</font>;

<font color="blue">inline</font> <font color="blue">bool</font> <font color="blue">operator</font> <font color="black">=</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> Rect<font color="black">&</font> r1, <font color="blue">const</font> Rect<font color="black">&</font> r2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font> <font color="black">(</font>r1.x <font color="black">=</font><font color="black">=</font> r2.x<font color="black">)</font> <font color="black">&</font><font color="black">&</font>
       <font color="black">(</font>r1.y <font color="black">=</font><font color="black">=</font> r2.y<font color="black">)</font> <font color="black">&</font><font color="black">&</font>
       <font color="black">(</font>r1.w <font color="black">=</font><font color="black">=</font> r2.w<font color="black">)</font> <font color="black">&</font><font color="black">&</font>
       <font color="black">(</font>r1.h <font color="black">=</font><font color="black">=</font> r2.h<font color="black">)</font> <font color="black">)</font>;
<font color="black">}</font>
  
<font color="green">/////////////////////</font>
<font color="green">//  PowerOf2</font>
<font color="green">/////////////////////</font>

<font color="blue">inline</font> <font color="blue">int</font> nextPowerOf2<font color="black">(</font><font color="blue">int</font> x, <font color="blue">int</font> max <font color="black">=</font> pow<font color="black">(</font><font color="maroon">2</font>, <font color="maroon">11</font><font color="black">)</font><font color="black">)</font>
<font color="black">{</font>
  <font color="blue">int</font> p2 <font color="black">=</font> <font color="maroon">1</font>;
  <font color="blue">while</font> <font color="black">(</font>p2 <font color="black">&#60;</font> x <font color="black">&</font><font color="black">&</font> p2 <font color="black">&#60;</font><font color="black">=</font> max<font color="black">)</font>
  <font color="black">{</font>
    p2 <font color="black">*</font><font color="black">=</font> <font color="maroon">2</font>;
  <font color="black">}</font>
  <font color="blue">return</font> p2;
<font color="black">}</font>

<font color="blue">inline</font> <font color="blue">int</font> previousPowerOf2<font color="black">(</font><font color="blue">int</font> x, <font color="blue">int</font> max<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">int</font> p<font color="black">=</font>nextPowerOf2<font color="black">(</font>x, max<font color="black">)</font> ;
  <font color="blue">if</font> <font color="black">(</font>p<font color="black">!</font><font color="black">=</font><font color="maroon">1</font> <font color="black">&</font><font color="black">&</font> p<font color="black">!</font><font color="black">=</font>x<font color="black">)</font>
  <font color="black">{</font>
    p <font color="black">=</font> p <font color="black">/</font> <font color="maroon">2</font>;
  <font color="black">}</font>

  <font color="blue">return</font> p;
<font color="black">}</font>


<font color="green">/////////////////////</font>
<font color="green">//  Geometry</font>
<font color="green">/////////////////////</font>

<font color="blue">inline</font> <font color="blue">int</font> dirToChange<font color="black">(</font><font color="blue">int</font> angle1, <font color="blue">int</font> angle2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">int</font> ans1 <font color="black">=</font> <font color="maroon">0</font>;

  <font color="blue">int</font> t<font color="black">=</font>angle1;
  <font color="blue">while</font> <font color="black">(</font>t <font color="black">!</font><font color="black">=</font> angle2<font color="black">)</font>
  <font color="black">{</font>
    t<font color="black">+</font><font color="black">+</font>;
    <font color="blue">if</font> <font color="black">(</font>t<font color="black">&#62;</font><font color="maroon">359</font><font color="black">)</font>
    <font color="black">{</font>
      t <font color="black">=</font> <font color="maroon">0</font>;
    <font color="black">}</font>
    ans1<font color="black">+</font><font color="black">+</font>;
    <font color="blue">if</font> <font color="black">(</font>ans1 <font color="black">&#62;</font><font color="black">=</font> <font color="maroon">180</font><font color="black">)</font>
    <font color="black">{</font>
      <font color="blue">return</font> <font color="maroon">-1</font>;
    <font color="black">}</font>
  <font color="black">}</font>
  <font color="blue">return</font> <font color="maroon">1</font>;
<font color="black">}</font>


<font color="blue">inline</font> 
<font color="blue">void</font> planeFromPoints<font color="black">(</font><font color="blue">double</font> x1, <font color="blue">double</font> y1, <font color="blue">double</font> z1,
                     <font color="blue">double</font> x2, <font color="blue">double</font> y2, <font color="blue">double</font> z2,
                     <font color="blue">double</font> x3, <font color="blue">double</font> y3, <font color="blue">double</font> z3,
                     <font color="blue">double</font><font color="black">&</font> A, <font color="blue">double</font><font color="black">&</font> B, <font color="blue">double</font><font color="black">&</font> C, <font color="blue">double</font><font color="black">&</font> D<font color="black">)</font>
<font color="black">{</font>
  A <font color="black">=</font> <font color="black">(</font>y1 <font color="black">*</font> <font color="black">(</font>z2 <font color="black">-</font>z3<font color="black">)</font><font color="black">)</font> <font color="black">+</font> <font color="black">(</font>y2 <font color="black">*</font> <font color="black">(</font>z3 <font color="black">-</font>z1<font color="black">)</font><font color="black">)</font> <font color="black">+</font> <font color="black">(</font>y3 <font color="black">*</font> <font color="black">(</font>z1 <font color="black">-</font>z2<font color="black">)</font><font color="black">)</font>;
  B <font color="black">=</font> <font color="black">(</font>z1 <font color="black">*</font> <font color="black">(</font>x2 <font color="black">-</font>x3<font color="black">)</font><font color="black">)</font> <font color="black">+</font> <font color="black">(</font>z2 <font color="black">*</font> <font color="black">(</font>x3 <font color="black">-</font>x1<font color="black">)</font><font color="black">)</font> <font color="black">+</font> <font color="black">(</font>z3 <font color="black">*</font> <font color="black">(</font>x1 <font color="black">-</font>x2<font color="black">)</font><font color="black">)</font>;
  C <font color="black">=</font> <font color="black">(</font>x1 <font color="black">*</font> <font color="black">(</font>y2 <font color="black">-</font>y3<font color="black">)</font><font color="black">)</font> <font color="black">+</font> <font color="black">(</font>x2 <font color="black">*</font> <font color="black">(</font>y3 <font color="black">-</font>y1<font color="black">)</font><font color="black">)</font> <font color="black">+</font> <font color="black">(</font>x3 <font color="black">*</font> <font color="black">(</font>y1 <font color="black">-</font>y2<font color="black">)</font><font color="black">)</font>;
  <font color="green">//- </font>
  D <font color="black">=</font> <font color="black">(</font>x1 <font color="black">*</font> <font color="black">(</font>y2 <font color="black">*</font> z3 <font color="black">-</font>y3 <font color="black">*</font> z2<font color="black">)</font> <font color="black">+</font> x2 <font color="black">*</font> <font color="black">(</font>y3 <font color="black">*</font> z1 <font color="black">-</font>y1 <font color="black">*</font> z3<font color="black">)</font> <font color="black">+</font> x3 <font color="black">*</font> <font color="black">(</font>y1 <font color="black">*</font> z2 <font color="black">-</font>y2 <font color="black">*</font> z1<font color="black">)</font><font color="black">)</font>;
<font color="black">}</font>


<font color="green">///////////////////</font>
<font color="green">/// LINES</font>
<font color="green">///////////////////</font>

<font color="blue">class</font> Line
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
  Line<font color="black">(</font><font color="black">)</font><font color="black">:</font> p1<font color="black">(</font>FPoint<font color="black">(</font><font color="maroon">0</font>, <font color="maroon">0</font><font color="black">)</font><font color="black">)</font>, p2<font color="black">(</font>FPoint<font color="black">(</font><font color="maroon">0</font>, <font color="maroon">0</font><font color="black">)</font><font color="black">)</font> <font color="black">{</font> <font color="black">}</font>
  Line<font color="black">(</font>FPoint p1, FPoint p2<font color="black">)</font><font color="black">:</font> p1<font color="black">(</font>p1<font color="black">)</font>, p2<font color="black">(</font>p2<font color="black">)</font> <font color="black">{</font> <font color="black">}</font>
  <font color="blue">float</font> length<font color="black">(</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> sqrt<font color="black">(</font>lengthSquared<font color="black">(</font><font color="black">)</font><font color="black">)</font>;
  <font color="black">}</font>
  <font color="blue">float</font> lengthSquared<font color="black">(</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="black">(</font><font color="black">(</font>p1.x<font color="black">-</font>p2.x<font color="black">)</font><font color="black">*</font><font color="black">(</font>p1.x<font color="black">-</font>p2.x<font color="black">)</font><font color="black">)</font> <font color="black">+</font> <font color="black">(</font><font color="black">(</font>p1.y<font color="black">-</font>p2.y<font color="black">)</font><font color="black">*</font><font color="black">(</font>p1.y<font color="black">-</font>p2.y<font color="black">)</font><font color="black">)</font>;
  <font color="black">}</font>

  FPoint p1;
  FPoint p2;
<font color="black">}</font>;

<font color="blue">inline</font> 
<font color="blue">float</font> inverse<font color="black">(</font><font color="blue">float</font> a<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font><font color="maroon">1</font><font color="black">/</font>a<font color="black">)</font>;
<font color="black">}</font>

<font color="blue">inline</font>
<font color="blue">float</font> getM<font color="black">(</font>FPoint p1, FPoint p2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font>p1.y <font color="black">-</font>p2.y<font color="black">)</font> <font color="black">/</font> <font color="black">(</font>p1.x <font color="black">-</font>p2.x<font color="black">)</font>;
<font color="black">}</font>
<font color="blue">inline</font>
<font color="blue">float</font> getMx<font color="black">(</font>FPoint p1, FPoint p2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font>p1.x <font color="black">-</font>p2.x<font color="black">)</font> <font color="black">/</font> <font color="black">(</font>p1.y <font color="black">-</font>p2.y<font color="black">)</font>;
<font color="black">}</font>
<font color="blue">inline</font>
<font color="blue">float</font> getB<font color="black">(</font>FPoint lp1, FPoint lp2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">float</font> m <font color="black">=</font> getM<font color="black">(</font>lp1, lp2<font color="black">)</font>;
  <font color="blue">return</font> <font color="black">(</font>lp1.y <font color="black">-</font><font color="black">(</font>m <font color="black">*</font> lp1.x<font color="black">)</font><font color="black">)</font>;
<font color="black">}</font>
<font color="blue">inline</font>
<font color="blue">float</font> getBx<font color="black">(</font>FPoint lp1, FPoint lp2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">float</font> m <font color="black">=</font> getMx<font color="black">(</font>lp1, lp2<font color="black">)</font>;
  <font color="blue">return</font> <font color="black">(</font>lp1.x <font color="black">-</font><font color="black">(</font>m <font color="black">*</font> lp1.y<font color="black">)</font><font color="black">)</font>;
<font color="black">}</font>



<font color="blue">inline</font>
<font color="blue">bool</font> areParallel<font color="black">(</font>FPoint l1_1, FPoint l1_2, FPoint l2_1, FPoint l2_2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">if</font> <font color="black">(</font>l1_1.x <font color="black">=</font><font color="black">=</font> l1_2.x <font color="black">&</font><font color="black">&</font> l2_1.x <font color="black">=</font><font color="black">=</font> l2_2.x<font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="blue">true</font>;
  <font color="black">}</font>

  <font color="green">// since they both arn't, then maybe one is and if so then thay arn't parallel</font>
  <font color="blue">if</font> <font color="black">(</font>l1_1.x <font color="black">=</font><font color="black">=</font> l1_2.x <font color="black">|</font><font color="black">|</font> l2_1.x <font color="black">=</font><font color="black">=</font> l2_2.x<font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="blue">false</font>;
  <font color="black">}</font>

  <font color="blue">float</font> m1 <font color="black">=</font> getM<font color="black">(</font>l1_1, l1_2<font color="black">)</font>;
  <font color="blue">float</font> m2 <font color="black">=</font> getM<font color="black">(</font>l2_1, l2_2<font color="black">)</font>;
  
  <font color="blue">return</font> m1<font color="black">=</font><font color="black">=</font>m2;
<font color="black">}</font>

<font color="blue">inline</font> 
<font color="blue">bool</font> arePerpendicular<font color="black">(</font>FPoint l1_1, FPoint l1_2, FPoint l2_1, FPoint l2_2<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">if</font> <font color="black">(</font>areParallel<font color="black">(</font>l1_1, l1_2, l2_1, l2_2<font color="black">)</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="blue">false</font>;
  <font color="black">}</font>

  <font color="blue">if</font> <font color="black">(</font>l1_1.x <font color="black">=</font><font color="black">=</font> l1_2.x<font color="black">)</font>
  <font color="black">{</font>
    <font color="green">// the first line is straight up and down</font>
    <font color="blue">float</font> m2 <font color="black">=</font> getM<font color="black">(</font>l2_1, l2_2<font color="black">)</font>;
    <font color="blue">return</font> <font color="black">(</font>m2 <font color="black">=</font><font color="black">=</font> <font color="maroon">1</font> <font color="black">|</font><font color="black">|</font> m2 <font color="black">=</font><font color="black">=</font> <font color="maroon">-1</font><font color="black">)</font>;
  <font color="black">}</font>
  <font color="blue">else</font> <font color="blue">if</font> <font color="black">(</font>l2_1.x <font color="black">=</font><font color="black">=</font> l2_2.x<font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">float</font> m1 <font color="black">=</font> getM<font color="black">(</font>l1_1, l1_2<font color="black">)</font>;
    <font color="blue">return</font> <font color="black">(</font>m1 <font color="black">=</font><font color="black">=</font> <font color="maroon">1</font> <font color="black">|</font><font color="black">|</font> m1 <font color="black">=</font><font color="black">=</font> <font color="maroon">-1</font><font color="black">)</font>;
  <font color="black">}</font>

  <font color="green">// neither are up and down</font>
  <font color="blue">float</font> m1 <font color="black">=</font> getM<font color="black">(</font>l1_1, l1_2<font color="black">)</font>;
  <font color="blue">float</font> m2 <font color="black">=</font> getM<font color="black">(</font>l2_1, l2_2<font color="black">)</font>;
  <font color="blue">return</font> <font color="black">(</font>m1 <font color="black">*</font> m2 <font color="black">=</font><font color="black">=</font> <font color="maroon">-1</font><font color="black">)</font>;
<font color="black">}</font>


<font color="blue">inline</font>
<font color="blue">bool</font> linesIntersect<font color="black">(</font>FPoint l1_1, FPoint l1_2, FPoint l2_1, FPoint l2_2, FPoint<font color="black">&</font> ans<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">if</font> <font color="black">(</font>areParallel<font color="black">(</font>l1_1, l1_2, l2_1, l2_2<font color="black">)</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">return</font> <font color="blue">false</font>;
  <font color="black">}</font>

  <font color="blue">float</font> m1 <font color="black">=</font> getM<font color="black">(</font>l1_1, l1_2<font color="black">)</font>;
  <font color="blue">float</font> m2 <font color="black">=</font> getM<font color="black">(</font>l2_1, l2_2<font color="black">)</font>;

  <font color="blue">float</font> b1 <font color="black">=</font> <font color="black">(</font>l1_1.y <font color="black">-</font><font color="black">(</font>m1 <font color="black">*</font> l1_1.x<font color="black">)</font><font color="black">)</font>;
  <font color="blue">float</font> b2 <font color="black">=</font> <font color="black">(</font>l2_1.y <font color="black">-</font><font color="black">(</font>m2 <font color="black">*</font> l2_1.x<font color="black">)</font><font color="black">)</font>;

  ans.x <font color="black">=</font> <font color="black">(</font>b2<font color="black">-</font>b1<font color="black">)</font> <font color="black">/</font> <font color="black">(</font>m1<font color="black">-</font>m2<font color="black">)</font>;
  ans.y <font color="black">=</font> <font color="black">(</font>m1<font color="black">*</font>ans.x<font color="black">)</font> <font color="black">+</font> b1;

  <font color="blue">return</font> <font color="blue">true</font>;
<font color="black">}</font>

<font color="blue">inline</font>
<font color="blue">bool</font> couldPointOnLineSegment<font color="black">(</font>Line l, FPoint p<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font>  <font color="black">(</font> <font color="black">(</font>p.x <font color="black">&#62;</font><font color="black">=</font> min<font color="black">(</font>l.p1.x, l.p2.x<font color="black">)</font><font color="black">)</font> <font color="black">&</font><font color="black">&</font>
       <font color="black">(</font>p.y <font color="black">&#62;</font><font color="black">=</font> min<font color="black">(</font>l.p1.y, l.p2.y<font color="black">)</font><font color="black">)</font> <font color="black">&</font><font color="black">&</font>
       <font color="black">(</font>p.x <font color="black">&#60;</font><font color="black">=</font> max<font color="black">(</font>l.p1.x, l.p2.x<font color="black">)</font><font color="black">)</font> <font color="black">&</font><font color="black">&</font>
       <font color="black">(</font>p.y <font color="black">&#60;</font><font color="black">=</font> max<font color="black">(</font>l.p1.y, l.p2.y<font color="black">)</font><font color="black">)</font>
       <font color="black">)</font>;
<font color="black">}</font>

<font color="blue">inline</font>
<font color="blue">bool</font> doesLineIntersectRect<font color="black">(</font>Line l, Rect r, FPoint<font color="black">&</font> ans<font color="black">)</font>
<font color="black">{</font>
  FPoint A<font color="black">(</font>r.x, r.y<font color="black">)</font>;
  FPoint B<font color="black">(</font>r.x<font color="black">+</font>r.w, r.y<font color="black">)</font>;
  FPoint C<font color="black">(</font>r.x<font color="black">+</font>r.w, r.y<font color="black">+</font>r.h<font color="black">)</font>;
  FPoint D<font color="black">(</font>r.x, r.y<font color="black">+</font>r.h<font color="black">)</font>;
<font color="green">//  FPoint ans;</font>

  <font color="blue">if</font> <font color="black">(</font>linesIntersect<font color="black">(</font>A, C, l.p1, l.p2, ans<font color="black">)</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">if</font> <font color="black">(</font>r.containsPoint<font color="black">(</font>Point<font color="black">(</font>ans.x, ans.y<font color="black">)</font><font color="black">)</font> <font color="black">&</font><font color="black">&</font> couldPointOnLineSegment<font color="black">(</font>l, ans<font color="black">)</font><font color="black">)</font>
    <font color="black">{</font>
      <font color="blue">return</font> <font color="blue">true</font>;
    <font color="black">}</font>
  <font color="black">}</font>

  <font color="blue">if</font> <font color="black">(</font>linesIntersect<font color="black">(</font>B, D, l.p1, l.p2, ans<font color="black">)</font><font color="black">)</font>
  <font color="black">{</font>
    <font color="blue">if</font> <font color="black">(</font>r.containsPoint<font color="black">(</font>Point<font color="black">(</font>ans.x, ans.y<font color="black">)</font><font color="black">)</font> <font color="black">&</font><font color="black">&</font> couldPointOnLineSegment<font color="black">(</font>l, ans<font color="black">)</font><font color="black">)</font>
    <font color="black">{</font>
      <font color="blue">return</font> <font color="blue">true</font>;
    <font color="black">}</font>
  <font color="black">}</font>
  <font color="blue">return</font> <font color="blue">false</font>;
<font color="black">}</font>

<font color="blue">float</font> distToSegment<font color="black">(</font><font color="blue">float</font> px, <font color="blue">float</font> py, <font color="blue">float</font> X1, <font color="blue">float</font> Y1, <font color="blue">float</font> X2, <font color="blue">float</font> Y2<font color="black">)</font>;
<font color="blue">float</font> distToSegmentSquared<font color="black">(</font><font color="blue">float</font> px, <font color="blue">float</font> py, <font color="blue">float</font> X1, <font color="blue">float</font> Y1, <font color="blue">float</font> X2, <font color="blue">float</font> Y2<font color="black">)</font>;

<font color="blue">inline</font> <font color="blue">float</font> distToSegmentSquared<font color="black">(</font>Point p, Line l<font color="black">)</font> <font color="black">{</font> <font color="blue">return</font> distToSegmentSquared<font color="black">(</font>p.x, p.y, l.p1.x, l.p1.y, l.p2.x, l.p2.y<font color="black">)</font>; <font color="black">}</font>
<font color="blue">inline</font> <font color="blue">float</font> distToSegment<font color="black">(</font>Point p, Line l<font color="black">)</font> <font color="black">{</font> <font color="blue">return</font> distToSegment<font color="black">(</font>p.x, p.y, l.p1.x, l.p1.y, l.p2.x, l.p2.y<font color="black">)</font>; <font color="black">}</font>

<font color="blue">inline</font>
FPoint rotate<font color="black">(</font>FPoint f, Angle angle<font color="black">)</font>
<font color="black">{</font>
  FPoint ret;
  ret.x <font color="black">=</font> costable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>f.x <font color="black">-</font>sintable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>f.y;
  ret.y <font color="black">=</font> sintable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>f.x <font color="black">+</font> costable<font color="black">[</font>angle<font color="black">]</font><font color="black">*</font>f.y;
  <font color="blue">return</font> ret;
<font color="black">}</font>


<font color="blue">template</font> <font color="black">&#60;</font>typename K<font color="black">&#62;</font> 
<font color="blue">inline</font>
K signOf<font color="black">(</font>K v<font color="black">)</font>
<font color="black">{</font>
  <font color="blue">return</font> <font color="black">(</font>v<font color="black">/</font>abs<font color="black">(</font>v<font color="black">)</font><font color="black">)</font>;
<font color="black">}</font>

<font color="blue">#endif</font>


</PRE>
</BODY>
</HTML>
